<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>äº•å­—æ£‹</title>
<style>
body { text-align: center; font-family: Arial, sans-serif; background: #f0f0f0; }
h2 { color: #ff6600; }
#board { display: grid; grid-template-columns: 60px 60px 60px; grid-gap: 5px; margin: 20px auto; }
.cell { width: 60px; height: 60px; background: #fff; border: 2px solid #333; display:flex; align-items:center; justify-content:center; font-size:36px; cursor:pointer; }
button, select { margin: 10px; padding: 5px 10px; font-size:16px; }
button:hover { background-color:#ff9900; color:white; cursor:pointer; }
</style>
</head>
<body>
<h2>äº•å­—æ£‹ âŒâ­•</h2>

<label>é€‰æ‹©æ¨¡å¼ï¼š
  <select id="modeSelect">
    <option value="computer">ç©å®¶ vs ç”µè„‘</option>
    <option value="human">ç©å®¶ vs ç©å®¶</option>
  </select>
</label>
<br>
<div id="board"></div>
<button onclick="resetGame()">é‡æ–°å¼€å§‹</button>

<script>
// ==== æ¸¸æˆæ•°æ® ====
let board = []; // æ£‹ç›˜æ•°ç»„
let currentPlayer = 'âŒ'; // å½“å‰ç©å®¶
let mode = 'computer';    // å¯¹æˆ˜æ¨¡å¼

// ==== åˆå§‹åŒ–æ£‹ç›˜ ====
function createBoard() {
    const container = document.getElementById('board');
    container.innerHTML = '';
    board = [['','',''],['','',''],['','','']];
    currentPlayer = 'âŒ';
    mode = document.getElementById('modeSelect').value;

    for(let y=0;y<3;y++){
        for(let x=0;x<3;x++){
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.dataset.x = x;
            cell.dataset.y = y;
            cell.addEventListener('click', handleMove);
            container.appendChild(cell);
        }
    }
}

// ==== ç©å®¶è½å­ ====
function handleMove(e){
    const x = parseInt(e.target.dataset.x);
    const y = parseInt(e.target.dataset.y);

    if(board[y][x] !== '') return; // å·²æœ‰æ£‹å­

    board[y][x] = currentPlayer;
    updateBoard();

    if(checkWin(currentPlayer)){
        alert(currentPlayer + ' è·èƒœï¼ğŸ‰');
        return;
    }
    if(isFull()){
        alert('å¹³å±€ï¼');
        return;
    }

    if(mode === 'human'){
        currentPlayer = currentPlayer === 'âŒ' ? 'â­•' : 'âŒ';
    } else if(mode === 'computer'){
        computerMove();
    }
}

// ==== ç”µè„‘è½å­ï¼ˆéšæœºï¼‰ ====
function computerMove(){
    let empty = [];
    for(let y=0;y<3;y++){
        for(let x=0;x<3;x++){
            if(board[y][x]==='') empty.push({x,y});
        }
    }
    if(empty.length===0) return;
    const move = empty[Math.floor(Math.random()*empty.length)];
    board[move.y][move.x] = 'â­•';
    updateBoard();

    if(checkWin('â­•')){
        alert('ç”µè„‘è·èƒœï¼ğŸ’»');
        return;
    }
    if(isFull()){
        alert('å¹³å±€ï¼');
        return;
    }
}

// ==== æ›´æ–°æ˜¾ç¤º ====
function updateBoard(){
    const cells = document.querySelectorAll('.cell');
    cells.forEach(c=>{
        const x = parseInt(c.dataset.x);
        const y = parseInt(c.dataset.y);
        c.textContent = board[y][x];
    });
}

// ==== æ£€æŸ¥èƒœåˆ© ====
function checkWin(player){
    for(let i=0;i<3;i++){
        if(board[i][0]===player && board[i][1]===player && board[i][2]===player) return true; // æ¨ª
        if(board[0][i]===player && board[1][i]===player && board[2][i]===player) return true; // çºµ
    }
    if(board[0][0]===player && board[1][1]===player && board[2][2]===player) return true; // å¯¹è§’
    if(board[0][2]===player && board[1][1]===player && board[2][0]===player) return true;
    return false;
}

// ==== æ£€æŸ¥å¹³å±€ ====
function isFull(){
    return board.flat().every(cell=>cell!=='');
}

// ==== é‡ç½®æ¸¸æˆ ====
function resetGame(){
    createBoard();
}

// ==== é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ– ====
createBoard();
</script>
</body>
</html>
